# Standard Kubernetes monitoring resources (no CRDs required)
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-skip-select
  namespace: atom-intents
  labels:
    grafana_dashboard: "1"
data:
  skip-select-dashboard.json: |
    {
      "annotations": {
        "list": []
      },
      "editable": true,
      "fiscalYearStartMonth": 0,
      "graphTooltip": 0,
      "id": null,
      "links": [],
      "liveNow": false,
      "panels": [
        {
          "title": "Request Rate",
          "type": "timeseries",
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
          "targets": [
            {
              "expr": "sum(rate(http_requests_total{service=\"skip-select\"}[5m])) by (method, path)",
              "legendFormat": "{{method}} {{path}}"
            }
          ]
        },
        {
          "title": "Error Rate",
          "type": "timeseries",
          "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
          "targets": [
            {
              "expr": "sum(rate(http_requests_total{service=\"skip-select\",status=~\"5..\"}[5m])) / sum(rate(http_requests_total{service=\"skip-select\"}[5m])) * 100",
              "legendFormat": "Error %"
            }
          ]
        },
        {
          "title": "Latency (p95)",
          "type": "timeseries",
          "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
          "targets": [
            {
              "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{service=\"skip-select\"}[5m])) by (le))",
              "legendFormat": "p95"
            }
          ]
        },
        {
          "title": "Active Intents",
          "type": "stat",
          "gridPos": {"h": 4, "w": 6, "x": 12, "y": 8},
          "targets": [
            {
              "expr": "skip_select_pending_intents",
              "legendFormat": "Pending"
            }
          ]
        },
        {
          "title": "Active Solvers",
          "type": "stat",
          "gridPos": {"h": 4, "w": 6, "x": 18, "y": 8},
          "targets": [
            {
              "expr": "skip_select_active_solvers",
              "legendFormat": "Active"
            }
          ]
        },
        {
          "title": "Auctions/min",
          "type": "stat",
          "gridPos": {"h": 4, "w": 6, "x": 12, "y": 12},
          "targets": [
            {
              "expr": "sum(rate(auctions_total[1m])) * 60",
              "legendFormat": "Auctions"
            }
          ]
        },
        {
          "title": "Settlements/min",
          "type": "stat",
          "gridPos": {"h": 4, "w": 6, "x": 18, "y": 12},
          "targets": [
            {
              "expr": "sum(rate(settlements_total{status=\"completed\"}[1m])) * 60",
              "legendFormat": "Completed"
            }
          ]
        }
      ],
      "refresh": "10s",
      "schemaVersion": 38,
      "style": "dark",
      "tags": ["atom-intents", "skip-select"],
      "templating": {"list": []},
      "time": {"from": "now-1h", "to": "now"},
      "timepicker": {},
      "timezone": "",
      "title": "Skip Select Simulator",
      "version": 1
    }
